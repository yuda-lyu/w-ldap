/*!
 * w-ldap v1.0.1
 * (c) 2018-2019 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("path"),require("fs"),require("process"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","process","child_process"],r):(t=t||self)["w-ldap"]=r(t.path,t.fs,t.process,t.child_process)}(this,(function(t,r,e,n){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t,r){return t(r={exports:{}},r.exports),r.exports}var a=i((function(t){function r(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=r=function(t){return typeof t}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(e)}t.exports=r})),u=i((function(t){var r=function(t){var r=Object.prototype,e=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",u=n.toStringTag||"@@toStringTag";function c(t,r,e,n){var o=r&&r.prototype instanceof l?r:l,i=Object.create(o.prototype),a=new j(n||[]);return i._invoke=function(t,r,e){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return O()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var u=b(a,e);if(u){if(u===f)continue;return u}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===n)throw n="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n="executing";var c=s(t,r,e);if("normal"===c.type){if(n=e.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(n="completed",e.method="throw",e.arg=c.arg)}}}(t,e,a),i}function s(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function l(){}function p(){}function h(){}var v={};v[o]=function(){return this};var d=Object.getPrototypeOf,y=d&&d(d(S([])));y&&y!==r&&e.call(y,o)&&(v=y);var g=h.prototype=l.prototype=Object.create(v);function m(t){["next","throw","return"].forEach((function(r){t[r]=function(t){return this._invoke(r,t)}}))}function _(t,r){var n;this._invoke=function(o,i){function u(){return new r((function(n,u){!function n(o,i,u,c){var f=s(t[o],t,i);if("throw"!==f.type){var l=f.arg,p=l.value;return p&&"object"===a(p)&&e.call(p,"__await")?r.resolve(p.__await).then((function(t){n("next",t,u,c)}),(function(t){n("throw",t,u,c)})):r.resolve(p).then((function(t){l.value=t,u(l)}),(function(t){return n("throw",t,u,c)}))}c(f.arg)}(o,i,n,u)}))}return n=n?n.then(u,u):u()}}function b(t,r){var e=t.iterator[r.method];if(void 0===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=void 0,b(t,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(e,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,f;var o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function w(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function x(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function S(t){if(t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(e.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=void 0,r.done=!0,r};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=g.constructor=h,h.constructor=p,h[u]=p.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(_.prototype),_.prototype[i]=function(){return this},t.AsyncIterator=_,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var a=new _(c(r,e,n,o),i);return t.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(g),g[u]="Generator",g[o]=function(){return this},g.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=S,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var r in this)"t"===r.charAt(0)&&e.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(e,n){return a.type="throw",a.arg=t,r.next=e,n&&(r.method="next",r.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=e.call(i,"catchLoc"),c=e.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,r){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&e.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),f},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),x(e),f}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;x(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,e){return this.delegate={iterator:S(t),resultName:r,nextLoc:e},"next"===this.method&&(this.arg=void 0),f}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}}));function c(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var s=function(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){c(i,n,o,a,u,"next",t)}function u(t){c(i,n,o,a,u,"throw",t)}a(void 0)}))}},f=Array.isArray,l="object"==a(o)&&o&&o.Object===Object&&o,p="object"==("undefined"==typeof self?"undefined":a(self))&&self&&self.Object===Object&&self,h=l||p||Function("return this")(),v=h.Symbol,d=Object.prototype,y=d.hasOwnProperty,g=d.toString,m=v?v.toStringTag:void 0;var _=function(t){var r=y.call(t,m),e=t[m];try{t[m]=void 0;var n=!0}catch(t){}var o=g.call(t);return n&&(r?t[m]=e:delete t[m]),o},b=Object.prototype.toString;var w=function(t){return b.call(t)},x=v?v.toStringTag:void 0;var j=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":x&&x in Object(t)?_(t):w(t)};var S=function(t){return null!=t&&"object"==a(t)};var O=function(t){return"symbol"==a(t)||S(t)&&"[object Symbol]"==j(t)},P=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,L=/^\w*$/;var E=function(t,r){if(f(t))return!1;var e=a(t);return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!O(t))||(L.test(t)||!P.test(t)||null!=r&&t in Object(r))};var k=function(t){var r=a(t);return null!=t&&("object"==r||"function"==r)};var A,B=function(t){if(!k(t))return!1;var r=j(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r},z=h["__core-js_shared__"],N=(A=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"";var F=function(t){return!!N&&N in t},C=Function.prototype.toString;var $=function(t){if(null!=t){try{return C.call(t)}catch(t){}try{return t+""}catch(t){}}return""},I=/^\[object .+?Constructor\]$/,T=Function.prototype,G=Object.prototype,M=T.toString,U=G.hasOwnProperty,R=RegExp("^"+M.call(U).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var D=function(t){return!(!k(t)||F(t))&&(B(t)?R:I).test($(t))};var H=function(t,r){return null==t?void 0:t[r]};var q=function(t,r){var e=H(t,r);return D(e)?e:void 0},W=q(Object,"create");var J=function(){this.__data__=W?W(null):{},this.size=0};var Y=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},K=Object.prototype.hasOwnProperty;var Q=function(t){var r=this.__data__;if(W){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return K.call(r,t)?r[t]:void 0},V=Object.prototype.hasOwnProperty;var X=function(t){var r=this.__data__;return W?void 0!==r[t]:V.call(r,t)};var Z=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=W&&void 0===r?"__lodash_hash_undefined__":r,this};function tt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}tt.prototype.clear=J,tt.prototype.delete=Y,tt.prototype.get=Q,tt.prototype.has=X,tt.prototype.set=Z;var rt=tt;var et=function(){this.__data__=[],this.size=0};var nt=function(t,r){return t===r||t!=t&&r!=r};var ot=function(t,r){for(var e=t.length;e--;)if(nt(t[e][0],r))return e;return-1},it=Array.prototype.splice;var at=function(t){var r=this.__data__,e=ot(r,t);return!(e<0)&&(e==r.length-1?r.pop():it.call(r,e,1),--this.size,!0)};var ut=function(t){var r=this.__data__,e=ot(r,t);return e<0?void 0:r[e][1]};var ct=function(t){return ot(this.__data__,t)>-1};var st=function(t,r){var e=this.__data__,n=ot(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};function ft(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ft.prototype.clear=et,ft.prototype.delete=at,ft.prototype.get=ut,ft.prototype.has=ct,ft.prototype.set=st;var lt=ft,pt=q(h,"Map");var ht=function(){this.size=0,this.__data__={hash:new rt,map:new(pt||lt),string:new rt}};var vt=function(t){var r=a(t);return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t};var dt=function(t,r){var e=t.__data__;return vt(r)?e["string"==typeof r?"string":"hash"]:e.map};var yt=function(t){var r=dt(this,t).delete(t);return this.size-=r?1:0,r};var gt=function(t){return dt(this,t).get(t)};var mt=function(t){return dt(this,t).has(t)};var _t=function(t,r){var e=dt(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function bt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}bt.prototype.clear=ht,bt.prototype.delete=yt,bt.prototype.get=gt,bt.prototype.has=mt,bt.prototype.set=_t;var wt=bt;function xt(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var e=function e(){var n=arguments,o=r?r.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return e.cache=i.set(o,a)||i,a};return e.cache=new(xt.Cache||wt),e}xt.Cache=wt;var jt=xt;var St=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/\\(\\)?/g,Pt=function(t){var r=jt(t,(function(t){return 500===e.size&&e.clear(),t})),e=r.cache;return r}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(St,(function(t,e,n,o){r.push(n?o.replace(Ot,"$1"):e||t)})),r}));var Lt=function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o},Et=v?v.prototype:void 0,kt=Et?Et.toString:void 0;var At=function t(r){if("string"==typeof r)return r;if(f(r))return Lt(r,t)+"";if(O(r))return kt?kt.call(r):"";var e=r+"";return"0"==e&&1/r==-1/0?"-0":e};var Bt=function(t){return null==t?"":At(t)};var zt=function(t,r){return f(t)?t:E(t,r)?[t]:Pt(Bt(t))};var Nt=function(t){if("string"==typeof t||O(t))return t;var r=t+"";return"0"==r&&1/t==-1/0?"-0":r};var Ft=function(t,r){for(var e=0,n=(r=zt(r,t)).length;null!=t&&e<n;)t=t[Nt(r[e++])];return e&&e==n?t:void 0};var Ct=function(t,r,e){var n=null==t?void 0:Ft(t,r);return void 0===n?e:n},$t=/^\s+|\s+$/g,It=/^[-+]0x[0-9a-f]+$/i,Tt=/^0b[01]+$/i,Gt=/^0o[0-7]+$/i,Mt=parseInt;var Ut=function(t){if("number"==typeof t)return t;if(O(t))return NaN;if(k(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=k(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=t.replace($t,"");var e=Tt.test(t);return e||Gt.test(t)?Mt(t.slice(2),e?2:8):It.test(t)?NaN:+t};var Rt=function(t){return t?(t=Ut(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var Dt=function(t){var r=Rt(t),e=r%1;return r==r?e?r-e:r:0};var Ht=function(t){return"number"==typeof t&&t==Dt(t)};function qt(t){return"[object String]"===Object.prototype.toString.call(t)}function Wt(t){return!(!qt(t)||""===t)}function Jt(t){var r=!1;return Wt(t)?r=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(r=!0),r}function Yt(t){return Jt(t)?Rt(t):0}var Kt=h.isFinite,Qt=Math.min;var Vt=function(t){var r=Math[t];return function(t,e){if(t=Ut(t),(e=null==e?0:Qt(Dt(e),292))&&Kt(t)){var n=(Bt(t)+"e").split("e"),o=r(n[0]+"e"+(+n[1]+e));return+((n=(Bt(o)+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}("round");function Xt(t){if(!Jt(t))return 0;t=Yt(t);var r=Vt(t);return"0"===String(r)?0:r}function Zt(t){return!!function(t){return!!Jt(t)&&(t=Yt(t),Ht(t))}(t)&&Xt(t)>0}var tr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),rr=tr.length;function er(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,r=[];t=Zt(t)?Xt(t):32;for(var e=0;e<t;e++)r[e]=tr[0|Math.random()*rr];var n=r.join("");return n}var nr=i((function(t,r){var e;t.exports=(e=e||function(t,r){var e=Object.create||function(){function t(){}return function(r){var e;return t.prototype=r,e=new t,t.prototype=null,e}}(),n={},o=n.lib={},i=o.Base={extend:function(t){var r=e(this);return t&&r.mixIn(t),r.hasOwnProperty("init")&&this.init!==r.init||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=i.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=null!=r?r:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var r=this.words,e=t.words,n=this.sigBytes,o=t.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var a=e[i>>>2]>>>24-i%4*8&255;r[n+i>>>2]|=a<<24-(n+i)%4*8}else for(i=0;i<o;i+=4)r[n+i>>>2]=e[i>>>2];return this.sigBytes+=o,this},clamp:function(){var r=this.words,e=this.sigBytes;r[e>>>2]&=4294967295<<32-e%4*8,r.length=t.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(r){for(var e,n=[],o=function(r){r=r;var e=987654321,n=4294967295;return function(){var o=((e=36969*(65535&e)+(e>>16)&n)<<16)+(r=18e3*(65535&r)+(r>>16)&n)&n;return o/=4294967296,(o+=.5)*(t.random()>.5?1:-1)}},i=0;i<r;i+=4){var u=o(4294967296*(e||t.random()));e=987654071*u(),n.push(4294967296*u()|0)}return new a.init(n,r)}}),u=n.enc={},c=u.Hex={stringify:function(t){for(var r=t.words,e=t.sigBytes,n=[],o=0;o<e;o++){var i=r[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var r=t.length,e=[],n=0;n<r;n+=2)e[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new a.init(e,r/2)}},s=u.Latin1={stringify:function(t){for(var r=t.words,e=t.sigBytes,n=[],o=0;o<e;o++){var i=r[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(t){for(var r=t.length,e=[],n=0;n<r;n++)e[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new a.init(e,r)}},f=u.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},l=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(r){var e=this._data,n=e.words,o=e.sigBytes,i=this.blockSize,u=o/(4*i),c=(u=r?t.ceil(u):t.max((0|u)-this._minBufferSize,0))*i,s=t.min(4*c,o);if(c){for(var f=0;f<c;f+=i)this._doProcessBlock(n,f);var l=n.splice(0,c);e.sigBytes-=s}return new a.init(l,s)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),p=(o.Hasher=l.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(r,e){return new t.init(e).finalize(r)}},_createHmacHelper:function(t){return function(r,e){return new p.HMAC.init(t,e).finalize(r)}}}),n.algo={});return n}(Math),e)})),or=i((function(t,r){t.exports=nr.enc.Utf8})),ir=i((function(t,r){var e,n,o;t.exports=(n=(e=o=nr).lib.WordArray,e.enc.Base64={stringify:function(t){var r=t.words,e=t.sigBytes,n=this._map;t.clamp();for(var o=[],i=0;i<e;i+=3)for(var a=(r[i>>>2]>>>24-i%4*8&255)<<16|(r[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|r[i+2>>>2]>>>24-(i+2)%4*8&255,u=0;u<4&&i+.75*u<e;u++)o.push(n.charAt(a>>>6*(3-u)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(t){var r=t.length,e=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<e.length;i++)o[e.charCodeAt(i)]=i}var a=e.charAt(64);if(a){var u=t.indexOf(a);-1!==u&&(r=u)}return function(t,r,e){for(var o=[],i=0,a=0;a<r;a++)if(a%4){var u=e[t.charCodeAt(a-1)]<<a%4*2,c=e[t.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=(u|c)<<24-i%4*8,i++}return n.create(o,i)}(t,r,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)}));function ar(t){if(!Wt(t))return"";var r=or.parse(t);return ir.stringify(r)}function ur(t){return Wt(t)?ir.parse(t).toString(or):""}function cr(t){if(!Wt(t))return{};var r={};try{r=JSON.parse(t)}catch(t){r={}}return r}function sr(t){return"[object Array]"===Object.prototype.toString.call(t)}function fr(t,r){return new Promise((function(e,o){sr(r)||(r=[r]);var i=n.spawnSync(t,r),a=i.stdout.toString("utf8"),u=i.stderr.toString("utf8");u?o(u):e(a)}))}function lr(t){return!!r.existsSync(t)&&(!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink())}function pr(t){return"[object Object]"===Object.prototype.toString.call(t)}function hr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(pr(t)){for(var r in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!qt(t)||""!==t)}(t)||!!function(t){return!!sr(t)&&0===t.length}(t))))}function vr(t){return!!sr(t)&&(0!==t.length&&(1!==t.length||!hr(t[0])))}function dr(t,r){if(Wt(t))t=[t];else if(!vr(t))return!1;if(Wt(r))r=[r];else if(!vr(r))return!1;for(var e=0;e<t.length;e++)for(var n=0;n<r.length;n++)if(t[e]===r[n])return!0;return!1}function yr(t){if(pr(t)){for(var r in t)return!0;return!1}return!1}var gr=t.resolve();function mr(){return"win32"===e.platform}function _r(){var t="connLDAP.net".concat("4.7.2",".exe"),r="".concat(gr,"/src/"),e="".concat(gr,"/node_modules/w-ldap/src/");return lr("".concat(r).concat(t))?r:lr("".concat(e).concat(t))?e:{error:"can not find executable file for connLDAP"}}function br(t,r){var e="connLDAP.net".concat(r,".exe");return"".concat(t).concat(e)}function wr(t){return t.replace(String.fromCharCode("65279"),"")}function xr(){return(xr=s(u.mark((function t(){var e,n,o,i,a,c,s,f,l,p,h,v,d,y=arguments;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=y.length>0&&void 0!==y[0]?y[0]:{},n=y.length>1&&void 0!==y[1]?y[1]:{},mr()){t.next=4;break}return t.abrupt("return",Promise.reject("operating system is not windows"));case 4:if(yr(e)){t.next=6;break}return t.abrupt("return",Promise.reject("invalid input"));case 6:if("logIn"===(o=Ct(e,"mode"))||"listUsers"===o){t.next=9;break}return t.abrupt("return",Promise.reject("input.mode needs to be 'logIn or 'listUsers"));case 9:if(Wt(Ct(e,"account"))){t.next=11;break}return t.abrupt("return",Promise.reject("invalid input.account"));case 11:if(Wt(Ct(e,"password"))){t.next=13;break}return t.abrupt("return",Promise.reject("invalid input.password"));case 13:if(Wt(Ct(e,"ldappath"))){t.next=15;break}return t.abrupt("return",Promise.reject("invalid input.ldappath"));case 15:if(Wt(i=Ct(n,"ver",null))||(i="4.7.2"),dr(i,["4.5","4.6","4.7.2"])){t.next=19;break}return t.abrupt("return",Promise.reject("opt.ver needs to be one of 4.5, 4.6 and 4.7.2"));case 19:if(a=_r(),!Ct(a,"error")){t.next=22;break}return t.abrupt("return",Promise.reject(a.error));case 22:return c=br(a,i),s="_".concat(er()),e["__System:OutputFilename"]=s,f=JSON.stringify(e),l=ar(f),t.next=29,fr(c,l).catch((function(t){console.log("WLdap execScript catch",t)}));case 29:if(p="".concat(a).concat(s),h=wr(h=r.readFileSync(p,"utf8")),v=ur(h),d=cr(v),r.unlinkSync(p),!Ct(d,"error")){t.next=37;break}return t.abrupt("return",Promise.reject(d.error));case 37:return t.abrupt("return",Ct(d,"success")||d);case 38:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){return xr.apply(this,arguments)}}));
//# sourceMappingURL=w-ldap.umd.js.map
