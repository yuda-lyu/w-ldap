/*!
 * w-ldap v1.0.12
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("path"),require("fs"),require("process"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","process","child_process"],r):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-ldap"]=r(t.path,t.fs,t.process,t.child_process)}(this,(function(t,r,e,n){"use strict";var o=Array.isArray,i="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,a=i||u||Function("return this")(),c=a.Symbol,f=Object.prototype,s=f.hasOwnProperty,l=f.toString,p=c?c.toStringTag:void 0;var h=Object.prototype.toString;var v="[object Null]",y="[object Undefined]",d=c?c.toStringTag:void 0;function b(t){return null==t?void 0===t?y:v:d&&d in Object(t)?function(t){var r=s.call(t,p),e=t[p];try{t[p]=void 0;var n=!0}catch(t){}var o=l.call(t);return n&&(r?t[p]=e:delete t[p]),o}(t):function(t){return h.call(t)}(t)}function g(t){return null!=t&&"object"==typeof t}var _="[object Symbol]";function j(t){return"symbol"==typeof t||g(t)&&b(t)==_}var w=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function O(t,r){if(o(t))return!1;var e=typeof t;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!j(t))||(m.test(t)||!w.test(t)||null!=r&&t in Object(r))}function S(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)}var A="[object AsyncFunction]",x="[object Function]",P="[object GeneratorFunction]",z="[object Proxy]";function B(t){if(!S(t))return!1;var r=b(t);return r==x||r==P||r==A||r==z}var $,k=a["__core-js_shared__"],C=($=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var M=Function.prototype.toString;function T(t){if(null!=t){try{return M.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var E=/^\[object .+?Constructor\]$/,F=Function.prototype,I=Object.prototype,U=F.toString,D=I.hasOwnProperty,N=RegExp("^"+U.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function L(t){return!(!S(t)||(r=t,C&&C in r))&&(B(t)?N:E).test(T(t));var r}function R(t,r){var e=function(t,r){return null==t?void 0:t[r]}(t,r);return L(e)?e:void 0}var q=R(Object,"create");var H=Object.prototype.hasOwnProperty;var V=Object.prototype.hasOwnProperty;function W(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function J(t,r){return t===r||t!=t&&r!=r}function G(t,r){for(var e=t.length;e--;)if(J(t[e][0],r))return e;return-1}W.prototype.clear=function(){this.__data__=q?q(null):{},this.size=0},W.prototype.delete=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},W.prototype.get=function(t){var r=this.__data__;if(q){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return H.call(r,t)?r[t]:void 0},W.prototype.has=function(t){var r=this.__data__;return q?void 0!==r[t]:V.call(r,t)},W.prototype.set=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=q&&void 0===r?"__lodash_hash_undefined__":r,this};var K=Array.prototype.splice;function Q(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Q.prototype.clear=function(){this.__data__=[],this.size=0},Q.prototype.delete=function(t){var r=this.__data__,e=G(r,t);return!(e<0)&&(e==r.length-1?r.pop():K.call(r,e,1),--this.size,!0)},Q.prototype.get=function(t){var r=this.__data__,e=G(r,t);return e<0?void 0:r[e][1]},Q.prototype.has=function(t){return G(this.__data__,t)>-1},Q.prototype.set=function(t,r){var e=this.__data__,n=G(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};var X=R(a,"Map");function Y(t,r){var e,n,o=t.__data__;return("string"==(n=typeof(e=r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof r?"string":"hash"]:o.map}function Z(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.size=0,this.__data__={hash:new W,map:new(X||Q),string:new W}},Z.prototype.delete=function(t){var r=Y(this,t).delete(t);return this.size-=r?1:0,r},Z.prototype.get=function(t){return Y(this,t).get(t)},Z.prototype.has=function(t){return Y(this,t).has(t)},Z.prototype.set=function(t,r){var e=Y(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};var tt="Expected a function";function rt(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError(tt);var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return e.cache=i.set(o,u)||i,u};return e.cache=new(rt.Cache||Z),e}rt.Cache=Z;var et,nt,ot,it=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ut=/\\(\\)?/g,at=(et=function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(it,(function(t,e,n,o){r.push(n?o.replace(ut,"$1"):e||t)})),r},nt=rt(et,(function(t){return 500===ot.size&&ot.clear(),t})),ot=nt.cache,nt),ct=at;function ft(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}var st=1/0,lt=c?c.prototype:void 0,pt=lt?lt.toString:void 0;function ht(t){if("string"==typeof t)return t;if(o(t))return ft(t,ht)+"";if(j(t))return pt?pt.call(t):"";var r=t+"";return"0"==r&&1/t==-st?"-0":r}function vt(t){return null==t?"":ht(t)}function yt(t,r){return o(t)?t:O(t,r)?[t]:ct(vt(t))}var dt=1/0;function bt(t){if("string"==typeof t||j(t))return t;var r=t+"";return"0"==r&&1/t==-dt?"-0":r}function gt(t,r){for(var e=0,n=(r=yt(r,t)).length;null!=t&&e<n;)t=t[bt(r[e++])];return e&&e==n?t:void 0}function _t(t,r,e){var n=null==t?void 0:gt(t,r);return void 0===n?e:n}var jt=/\s/;var wt=/^\s+/;function mt(t){return t?t.slice(0,function(t){for(var r=t.length;r--&&jt.test(t.charAt(r)););return r}(t)+1).replace(wt,""):t}var Ot=NaN,St=/^[-+]0x[0-9a-f]+$/i,At=/^0b[01]+$/i,xt=/^0o[0-7]+$/i,Pt=parseInt;function zt(t){if("number"==typeof t)return t;if(j(t))return Ot;if(S(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=S(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=mt(t);var e=At.test(t);return e||xt.test(t)?Pt(t.slice(2),e?2:8):St.test(t)?Ot:+t}var Bt=1/0,$t=17976931348623157e292;function kt(t){return t?(t=zt(t))===Bt||t===-Bt?(t<0?-1:1)*$t:t==t?t:0:0===t?t:0}function Ct(t){var r=kt(t),e=r%1;return r==r?e?r-e:r:0}function Mt(t){return"[object String]"===Object.prototype.toString.call(t)}function Tt(t){return!(!Mt(t)||""===t)}function Et(t){return t!=t}function Ft(t){let r=!1;if(Tt(t))r=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Et(t))return!1;r=!0}return r}function It(t){if(!Ft(t))return 0;return kt(t)}function Ut(t){return!!Ft(t)&&(t=It(t),"number"==typeof(r=t)&&r==Ct(r));var r}var Dt=a.isFinite,Nt=Math.min;var Lt=function(t){var r=Math[t];return function(t,e){if(t=zt(t),(e=null==e?0:Nt(Ct(e),292))&&Dt(t)){var n=(vt(t)+"e").split("e");return+((n=(vt(r(n[0]+"e"+(+n[1]+e)))+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}("round"),Rt=Lt;function qt(t){if(!Ft(t))return 0;t=It(t);let r=Rt(t);return"0"===String(r)?0:r}let Ht="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Vt=Ht.length;function Wt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,r=[];var e;t=Ut(e=t)&&qt(e)>0?qt(t):32;for(let e=0;e<t;e++)r[e]=Ht[0|Math.random()*Vt];return r.join("")}var Jt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Gt(t){if(t.__esModule)return t;var r=t.default;if("function"==typeof r){var e=function t(){if(this instanceof t){var e=[null];return e.push.apply(e,arguments),new(Function.bind.apply(r,e))}return r.apply(this,arguments)};e.prototype=r.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach((function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})})),e}var Kt={},Qt={get exports(){return Kt},set exports(t){Kt=t}};var Xt,Yt={},Zt={get exports(){return Yt},set exports(t){Yt=t}},tr=Gt(Object.freeze({__proto__:null,default:{}}));function rr(){return Xt||(Xt=1,function(t,r){var e;t.exports=(e=e||function(t,r){var e;if("undefined"!=typeof window&&window.crypto&&(e=window.crypto),"undefined"!=typeof self&&self.crypto&&(e=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(e=globalThis.crypto),!e&&"undefined"!=typeof window&&window.msCrypto&&(e=window.msCrypto),!e&&void 0!==Jt&&Jt.crypto&&(e=Jt.crypto),!e)try{e=tr}catch(t){}var n=function(){if(e){if("function"==typeof e.getRandomValues)try{return e.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof e.randomBytes)try{return e.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(r){var e;return t.prototype=r,e=new t,t.prototype=null,e}}(),i={},u=i.lib={},a=u.Base={extend:function(t){var r=o(this);return t&&r.mixIn(t),r.hasOwnProperty("init")&&this.init!==r.init||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},c=u.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=e!=r?e:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var r=this.words,e=t.words,n=this.sigBytes,o=t.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var u=e[i>>>2]>>>24-i%4*8&255;r[n+i>>>2]|=u<<24-(n+i)%4*8}else for(var a=0;a<o;a+=4)r[n+a>>>2]=e[a>>>2];return this.sigBytes+=o,this},clamp:function(){var r=this.words,e=this.sigBytes;r[e>>>2]&=4294967295<<32-e%4*8,r.length=t.ceil(e/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var r=[],e=0;e<t;e+=4)r.push(n());return new c.init(r,t)}}),f=i.enc={},s=f.Hex={stringify:function(t){for(var r=t.words,e=t.sigBytes,n=[],o=0;o<e;o++){var i=r[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var r=t.length,e=[],n=0;n<r;n+=2)e[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new c.init(e,r/2)}},l=f.Latin1={stringify:function(t){for(var r=t.words,e=t.sigBytes,n=[],o=0;o<e;o++){var i=r[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(t){for(var r=t.length,e=[],n=0;n<r;n++)e[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new c.init(e,r)}},p=f.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},h=u.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(r){var e,n=this._data,o=n.words,i=n.sigBytes,u=this.blockSize,a=i/(4*u),f=(a=r?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*u,s=t.min(4*f,i);if(f){for(var l=0;l<f;l+=u)this._doProcessBlock(o,l);e=o.splice(0,f),n.sigBytes-=s}return new c.init(e,s)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});u.Hasher=h.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(r,e){return new t.init(e).finalize(r)}},_createHmacHelper:function(t){return function(r,e){return new v.HMAC.init(t,e).finalize(r)}}});var v=i.algo={};return i}(Math),e)}(Zt)),Yt}!function(t,r){t.exports=rr().enc.Utf8}(Qt);var er=Kt,nr={};!function(t,r){var e;t.exports=(e=rr(),function(){var t=e,r=t.lib.WordArray;function n(t,e,n){for(var o=[],i=0,u=0;u<e;u++)if(u%4){var a=n[t.charCodeAt(u-1)]<<u%4*2|n[t.charCodeAt(u)]>>>6-u%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return r.create(o,i)}t.enc.Base64={stringify:function(t){var r=t.words,e=t.sigBytes,n=this._map;t.clamp();for(var o=[],i=0;i<e;i+=3)for(var u=(r[i>>>2]>>>24-i%4*8&255)<<16|(r[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|r[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<e;a++)o.push(n.charAt(u>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(t){var r=t.length,e=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<e.length;i++)o[e.charCodeAt(i)]=i}var u=e.charAt(64);if(u){var a=t.indexOf(u);-1!==a&&(r=a)}return n(t,r,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64)}({get exports(){return nr},set exports(t){nr=t}});var or=nr;function ir(t,r){for(var e=-1,n=null==t?0:t.length,o=0,i=[];++e<n;){var u=t[e];r(u,e,t)&&(i[o++]=u)}return i}var ur,ar=function(t,r,e){for(var n=-1,o=Object(t),i=e(t),u=i.length;u--;){var a=i[ur?u:++n];if(!1===r(o[a],a,o))break}return t};function cr(t){return g(t)&&"[object Arguments]"==b(t)}var fr=Object.prototype,sr=fr.hasOwnProperty,lr=fr.propertyIsEnumerable,pr=cr(function(){return arguments}())?cr:function(t){return g(t)&&sr.call(t,"callee")&&!lr.call(t,"callee")},hr=pr;var vr="object"==typeof exports&&exports&&!exports.nodeType&&exports,yr=vr&&"object"==typeof module&&module&&!module.nodeType&&module,dr=yr&&yr.exports===vr?a.Buffer:void 0,br=(dr?dr.isBuffer:void 0)||function(){return!1},gr=9007199254740991,_r=/^(?:0|[1-9]\d*)$/;function jr(t,r){var e=typeof t;return!!(r=null==r?gr:r)&&("number"==e||"symbol"!=e&&_r.test(t))&&t>-1&&t%1==0&&t<r}var wr=9007199254740991;function mr(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=wr}var Or={};Or["[object Float32Array]"]=Or["[object Float64Array]"]=Or["[object Int8Array]"]=Or["[object Int16Array]"]=Or["[object Int32Array]"]=Or["[object Uint8Array]"]=Or["[object Uint8ClampedArray]"]=Or["[object Uint16Array]"]=Or["[object Uint32Array]"]=!0,Or["[object Arguments]"]=Or["[object Array]"]=Or["[object ArrayBuffer]"]=Or["[object Boolean]"]=Or["[object DataView]"]=Or["[object Date]"]=Or["[object Error]"]=Or["[object Function]"]=Or["[object Map]"]=Or["[object Number]"]=Or["[object Object]"]=Or["[object RegExp]"]=Or["[object Set]"]=Or["[object String]"]=Or["[object WeakMap]"]=!1;var Sr="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ar=Sr&&"object"==typeof module&&module&&!module.nodeType&&module,xr=Ar&&Ar.exports===Sr&&i.process,Pr=function(){try{var t=Ar&&Ar.require&&Ar.require("util").types;return t||xr&&xr.binding&&xr.binding("util")}catch(t){}}(),zr=Pr&&Pr.isTypedArray,Br=zr?function(t){return function(r){return t(r)}}(zr):function(t){return g(t)&&mr(t.length)&&!!Or[b(t)]},$r=Br,kr=Object.prototype.hasOwnProperty;function Cr(t,r){var e=o(t),n=!e&&hr(t),i=!e&&!n&&br(t),u=!e&&!n&&!i&&$r(t),a=e||n||i||u,c=a?function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}(t.length,String):[],f=c.length;for(var s in t)!r&&!kr.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||u&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||jr(s,f))||c.push(s);return c}var Mr=Object.prototype;var Tr=function(t,r){return function(e){return t(r(e))}}(Object.keys,Object),Er=Tr,Fr=Object.prototype.hasOwnProperty;function Ir(t){if(e=(r=t)&&r.constructor,r!==("function"==typeof e&&e.prototype||Mr))return Er(t);var r,e,n=[];for(var o in Object(t))Fr.call(t,o)&&"constructor"!=o&&n.push(o);return n}function Ur(t){return null!=t&&mr(t.length)&&!B(t)}function Dr(t){return Ur(t)?Cr(t):Ir(t)}var Nr=function(t,r){return function(e,n){if(null==e)return e;if(!Ur(e))return t(e,n);for(var o=e.length,i=r?o:-1,u=Object(e);(r?i--:++i<o)&&!1!==n(u[i],i,u););return e}}((function(t,r){return t&&ar(t,r,Dr)})),Lr=Nr;function Rr(t,r){var e=[];return Lr(t,(function(t,n,o){r(t,n,o)&&e.push(t)})),e}function qr(t){var r=this.__data__=new Q(t);this.size=r.size}qr.prototype.clear=function(){this.__data__=new Q,this.size=0},qr.prototype.delete=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e},qr.prototype.get=function(t){return this.__data__.get(t)},qr.prototype.has=function(t){return this.__data__.has(t)},qr.prototype.set=function(t,r){var e=this.__data__;if(e instanceof Q){var n=e.__data__;if(!X||n.length<199)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new Z(n)}return e.set(t,r),this.size=e.size,this};function Hr(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new Z;++r<e;)this.add(t[r])}function Vr(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function Wr(t,r){return t.has(r)}Hr.prototype.add=Hr.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Hr.prototype.has=function(t){return this.__data__.has(t)};var Jr=1,Gr=2;function Kr(t,r,e,n,o,i){var u=e&Jr,a=t.length,c=r.length;if(a!=c&&!(u&&c>a))return!1;var f=i.get(t),s=i.get(r);if(f&&s)return f==r&&s==t;var l=-1,p=!0,h=e&Gr?new Hr:void 0;for(i.set(t,r),i.set(r,t);++l<a;){var v=t[l],y=r[l];if(n)var d=u?n(y,v,l,r,t,i):n(v,y,l,t,r,i);if(void 0!==d){if(d)continue;p=!1;break}if(h){if(!Vr(r,(function(t,r){if(!Wr(h,r)&&(v===t||o(v,t,e,n,i)))return h.push(r)}))){p=!1;break}}else if(v!==y&&!o(v,y,e,n,i)){p=!1;break}}return i.delete(t),i.delete(r),p}var Qr=a.Uint8Array;function Xr(t){var r=-1,e=Array(t.size);return t.forEach((function(t,n){e[++r]=[n,t]})),e}function Yr(t){var r=-1,e=Array(t.size);return t.forEach((function(t){e[++r]=t})),e}var Zr=1,te=2,re="[object Boolean]",ee="[object Date]",ne="[object Error]",oe="[object Map]",ie="[object Number]",ue="[object RegExp]",ae="[object Set]",ce="[object String]",fe="[object Symbol]",se="[object ArrayBuffer]",le="[object DataView]",pe=c?c.prototype:void 0,he=pe?pe.valueOf:void 0;var ve=Object.prototype.propertyIsEnumerable,ye=Object.getOwnPropertySymbols,de=ye?function(t){return null==t?[]:(t=Object(t),ir(ye(t),(function(r){return ve.call(t,r)})))}:function(){return[]};function be(t){return function(t,r,e){var n=r(t);return o(t)?n:function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t}(n,e(t))}(t,Dr,de)}var ge=1,_e=Object.prototype.hasOwnProperty;var je=R(a,"DataView"),we=R(a,"Promise"),me=R(a,"Set"),Oe=R(a,"WeakMap"),Se="[object Map]",Ae="[object Promise]",xe="[object Set]",Pe="[object WeakMap]",ze="[object DataView]",Be=T(je),$e=T(X),ke=T(we),Ce=T(me),Me=T(Oe),Te=b;(je&&Te(new je(new ArrayBuffer(1)))!=ze||X&&Te(new X)!=Se||we&&Te(we.resolve())!=Ae||me&&Te(new me)!=xe||Oe&&Te(new Oe)!=Pe)&&(Te=function(t){var r=b(t),e="[object Object]"==r?t.constructor:void 0,n=e?T(e):"";if(n)switch(n){case Be:return ze;case $e:return Se;case ke:return Ae;case Ce:return xe;case Me:return Pe}return r});var Ee=Te,Fe=1,Ie="[object Arguments]",Ue="[object Array]",De="[object Object]",Ne=Object.prototype.hasOwnProperty;function Le(t,r,e,n,i,u){var a=o(t),c=o(r),f=a?Ue:Ee(t),s=c?Ue:Ee(r),l=(f=f==Ie?De:f)==De,p=(s=s==Ie?De:s)==De,h=f==s;if(h&&br(t)){if(!br(r))return!1;a=!0,l=!1}if(h&&!l)return u||(u=new qr),a||$r(t)?Kr(t,r,e,n,i,u):function(t,r,e,n,o,i,u){switch(e){case le:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case se:return!(t.byteLength!=r.byteLength||!i(new Qr(t),new Qr(r)));case re:case ee:case ie:return J(+t,+r);case ne:return t.name==r.name&&t.message==r.message;case ue:case ce:return t==r+"";case oe:var a=Xr;case ae:var c=n&Zr;if(a||(a=Yr),t.size!=r.size&&!c)return!1;var f=u.get(t);if(f)return f==r;n|=te,u.set(t,r);var s=Kr(a(t),a(r),n,o,i,u);return u.delete(t),s;case fe:if(he)return he.call(t)==he.call(r)}return!1}(t,r,f,e,n,i,u);if(!(e&Fe)){var v=l&&Ne.call(t,"__wrapped__"),y=p&&Ne.call(r,"__wrapped__");if(v||y){var d=v?t.value():t,b=y?r.value():r;return u||(u=new qr),i(d,b,e,n,u)}}return!!h&&(u||(u=new qr),function(t,r,e,n,o,i){var u=e&ge,a=be(t),c=a.length;if(c!=be(r).length&&!u)return!1;for(var f=c;f--;){var s=a[f];if(!(u?s in r:_e.call(r,s)))return!1}var l=i.get(t),p=i.get(r);if(l&&p)return l==r&&p==t;var h=!0;i.set(t,r),i.set(r,t);for(var v=u;++f<c;){var y=t[s=a[f]],d=r[s];if(n)var b=u?n(d,y,s,r,t,i):n(y,d,s,t,r,i);if(!(void 0===b?y===d||o(y,d,e,n,i):b)){h=!1;break}v||(v="constructor"==s)}if(h&&!v){var g=t.constructor,_=r.constructor;g==_||!("constructor"in t)||!("constructor"in r)||"function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _||(h=!1)}return i.delete(t),i.delete(r),h}(t,r,e,n,i,u))}function Re(t,r,e,n,o){return t===r||(null==t||null==r||!g(t)&&!g(r)?t!=t&&r!=r:Le(t,r,e,n,Re,o))}var qe=1,He=2;function Ve(t){return t==t&&!S(t)}function We(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}}function Je(t){var r=function(t){for(var r=Dr(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,Ve(o)]}return r}(t);return 1==r.length&&r[0][2]?We(r[0][0],r[0][1]):function(e){return e===t||function(t,r,e,n){var o=e.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=e[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var c=(a=e[o])[0],f=t[c],s=a[1];if(u&&a[2]){if(void 0===f&&!(c in t))return!1}else{var l=new qr;if(n)var p=n(f,s,c,t,r,l);if(!(void 0===p?Re(s,f,qe|He,n,l):p))return!1}}return!0}(e,t,r)}}function Ge(t,r){return null!=t&&r in Object(t)}function Ke(t,r){return null!=t&&function(t,r,e){for(var n=-1,i=(r=yt(r,t)).length,u=!1;++n<i;){var a=bt(r[n]);if(!(u=null!=t&&e(t,a)))break;t=t[a]}return u||++n!=i?u:!!(i=null==t?0:t.length)&&mr(i)&&jr(a,i)&&(o(t)||hr(t))}(t,r,Ge)}var Qe=1,Xe=2;function Ye(t){return t}function Ze(t){return O(t)?(r=bt(t),function(t){return null==t?void 0:t[r]}):function(t){return function(r){return gt(r,t)}}(t);var r}function tn(t){return"function"==typeof t?t:null==t?Ye:"object"==typeof t?o(t)?function(t,r){return O(t)&&Ve(r)?We(bt(t),r):function(e){var n=_t(e,t);return void 0===n&&n===r?Ke(e,t):Re(r,n,Qe|Xe)}}(t[0],t[1]):Je(t):Ze(t)}function rn(t,r){var e=-1,n=Ur(t)?Array(t.length):[];return Lr(t,(function(t,o,i){n[++e]=r(t,o,i)})),n}var en=Array.prototype.join;function nn(t){return"[object Array]"===Object.prototype.toString.call(t)}function on(t,r){return new Promise((function(e,i){nn(r)||(r=[r]);let u=n.spawnSync(t,r),a=(c=u.output,f=t=>null!==t,(o(c)?ir:Rr)(c,tn(f)));var c,f;a=function(t,r){return(o(t)?ft:rn)(t,tn(r))}(a,(t=>function(t){try{return t.toString("utf8")}catch(t){}return""}(t)));let s=(p="",null==(l=a)?"":en.call(l,p));var l,p;let h=_t(u,"error.message");h?i(h):e(s)}))}function un(t){return!!r.existsSync(t)&&(!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink())}function an(t){return"[object Object]"===Object.prototype.toString.call(t)}function cn(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(an(t)){for(let r in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Mt(t)||""!==t)}(t)||(!!function(t){return!!nn(t)&&0===t.length}(t)||!!Et(t)))))}let fn=t.resolve();return async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("win32"!==e.platform)return Promise.reject("operating system is not windows");if(!function(t){if(an(t)){for(let r in t)return!0;return!1}return!1}(t))return Promise.reject("invalid input");let o=_t(t,"mode");if("logIn"!==o&&"listUsers"!==o)return Promise.reject("input.mode needs to be 'logIn or 'listUsers");if(!Tt(_t(t,"account")))return Promise.reject("invalid input.account");if(!Tt(_t(t,"password")))return Promise.reject("invalid input.password");if(!Tt(_t(t,"ldappath")))return Promise.reject("invalid input.ldappath");let i=_t(n,"ver",null);if(Tt(i)||(i="4.8"),!function(t,r){function e(t){return nn(t)?t:[t]}if(cn(t))return!1;if(0===(t=e(t)).length)return!1;if(cn(t))return!1;if(0===(r=e(r)).length)return!1;for(let e=0;e<t.length;e++)for(let i=0;i<r.length;i++)if(n=t[e],o=r[i],Re(n,o))return!0;var n,o;return!1}(i,["4.5","4.6","4.7.2","4.8"]))return Promise.reject("opt.ver needs to be one of 4.5, 4.6, 4.7.2 or 4.8");let u=function(){let t="connLDAP.net4.8.exe",r=`${fn}/src/`,e=`${fn}/node_modules/w-ldap/src/`;return un(`${r}${t}`)?r:un(`${e}${t}`)?e:{error:"can not find executable file for connLDAP"}}();if(_t(u,"error"))return Promise.reject(u.error);let a=function(t,r){return`${t}connLDAP.net${r}.exe`}(u,i),c=`_${Wt()}`;t["__System:OutputFilename"]=c;let f=function(t){if(!Tt(t))return"";let r=er.parse(t);return or.stringify(r)}(JSON.stringify(t));await on(a,f).catch((t=>{console.log("WLdap execScript catch",t)}));let s=`${u}${c}`,l=r.readFileSync(s,"utf8");var p;l=l.replace(String.fromCharCode("65279"),"");let h=function(t){if(!Tt(t))return{};let r={};try{r=JSON.parse(t)}catch(t){r={}}return r}(Tt(p=l)?or.parse(p).toString(er):"");return r.unlinkSync(s),_t(h,"error")?Promise.reject(h.error):_t(h,"success")||h}}));
//# sourceMappingURL=w-ldap.umd.js.map
