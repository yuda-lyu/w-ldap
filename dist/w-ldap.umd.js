/*!
 * w-ldap v1.0.14
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("process"),require("child_process")):"function"==typeof define&&define.amd?define(["path","fs","process","child_process"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-ldap"]=e(t.path,t.fs,t.process,t.child_process)}(this,(function(t,e,r,n){"use strict";var o=Array.isArray,i="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,a=i||u||Function("return this")(),c=a.Symbol,s=Object.prototype,f=s.hasOwnProperty,l=s.toString,p=c?c.toStringTag:void 0;var h=Object.prototype.toString;var d="[object Null]",y="[object Undefined]",v=c?c.toStringTag:void 0;function b(t){return null==t?void 0===t?y:d:v&&v in Object(t)?function(t){var e=f.call(t,p),r=t[p];try{t[p]=void 0;var n=!0}catch(t){}var o=l.call(t);return n&&(e?t[p]=r:delete t[p]),o}(t):function(t){return h.call(t)}(t)}function g(t){return null!=t&&"object"==typeof t}var _="[object Symbol]";function j(t){return"symbol"==typeof t||g(t)&&b(t)==_}var w=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function O(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var S="[object AsyncFunction]",x="[object Function]",A="[object GeneratorFunction]",P="[object Proxy]";function z(t){if(!O(t))return!1;var e=b(t);return e==x||e==A||e==S||e==P}var B,$=a["__core-js_shared__"],C=(B=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";var F=Function.prototype.toString;function E(t){if(null!=t){try{return F.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var k=/^\[object .+?Constructor\]$/,M=Function.prototype,T=Object.prototype,I=M.toString,U=T.hasOwnProperty,N=RegExp("^"+I.call(U).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function D(t){return!(!O(t)||(e=t,C&&C in e))&&(z(t)?N:k).test(E(t));var e}function L(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return D(r)?r:void 0}var R=L(Object,"create");var q=Object.prototype.hasOwnProperty;var H=Object.prototype.hasOwnProperty;function V(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function W(t,e){return t===e||t!=t&&e!=e}function J(t,e){for(var r=t.length;r--;)if(W(t[r][0],e))return r;return-1}V.prototype.clear=function(){this.__data__=R?R(null):{},this.size=0},V.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},V.prototype.get=function(t){var e=this.__data__;if(R){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return q.call(e,t)?e[t]:void 0},V.prototype.has=function(t){var e=this.__data__;return R?void 0!==e[t]:H.call(e,t)},V.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=R&&void 0===e?"__lodash_hash_undefined__":e,this};var G=Array.prototype.splice;function K(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}K.prototype.clear=function(){this.__data__=[],this.size=0},K.prototype.delete=function(t){var e=this.__data__,r=J(e,t);return!(r<0)&&(r==e.length-1?e.pop():G.call(e,r,1),--this.size,!0)},K.prototype.get=function(t){var e=this.__data__,r=J(e,t);return r<0?void 0:e[r][1]},K.prototype.has=function(t){return J(this.__data__,t)>-1},K.prototype.set=function(t,e){var r=this.__data__,n=J(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Q=L(a,"Map");function X(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Y.prototype.clear=function(){this.size=0,this.__data__={hash:new V,map:new(Q||K),string:new V}},Y.prototype.delete=function(t){var e=X(this,t).delete(t);return this.size-=e?1:0,e},Y.prototype.get=function(t){return X(this,t).get(t)},Y.prototype.has=function(t){return X(this,t).has(t)},Y.prototype.set=function(t,e){var r=X(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var Z="Expected a function";function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Z);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(tt.Cache||Y),r}tt.Cache=Y;var et,rt,nt,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/\\(\\)?/g,ut=(et=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,(function(t,r,n,o){e.push(n?o.replace(it,"$1"):r||t)})),e},rt=tt(et,(function(t){return 500===nt.size&&nt.clear(),t})),nt=rt.cache,rt),at=ut;var ct=1/0,st=c?c.prototype:void 0,ft=st?st.toString:void 0;function lt(t){if("string"==typeof t)return t;if(o(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(t,lt)+"";if(j(t))return ft?ft.call(t):"";var e=t+"";return"0"==e&&1/t==-ct?"-0":e}function pt(t){return null==t?"":lt(t)}function ht(t,e){return o(t)?t:function(t,e){if(o(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!j(t))||m.test(t)||!w.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:at(pt(t))}var dt=1/0;function yt(t){if("string"==typeof t||j(t))return t;var e=t+"";return"0"==e&&1/t==-dt?"-0":e}function vt(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=ht(e,t)).length;null!=t&&r<n;)t=t[yt(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}var bt=/\s/;var gt=/^\s+/;function _t(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&bt.test(t.charAt(e)););return e}(t)+1).replace(gt,""):t}var jt=NaN,wt=/^[-+]0x[0-9a-f]+$/i,mt=/^0b[01]+$/i,Ot=/^0o[0-7]+$/i,St=parseInt;function xt(t){if("number"==typeof t)return t;if(j(t))return jt;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=_t(t);var r=mt.test(t);return r||Ot.test(t)?St(t.slice(2),r?2:8):wt.test(t)?jt:+t}var At=1/0,Pt=17976931348623157e292;function zt(t){return t?(t=xt(t))===At||t===-At?(t<0?-1:1)*Pt:t==t?t:0:0===t?t:0}function Bt(t){var e=zt(t),r=e%1;return e==e?r?e-r:e:0}function $t(t){return"[object String]"===Object.prototype.toString.call(t)}function Ct(t){return!(!$t(t)||""===t)}function Ft(t){return t!=t}function Et(t){let e=!1;if(Ct(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Ft(t))return!1;e=!0}return e}function kt(t){if(!Et(t))return 0;return zt(t)}function Mt(t){return!!Et(t)&&(t=kt(t),"number"==typeof(e=t)&&e==Bt(e));var e}var Tt=a.isFinite,It=Math.min;var Ut=function(t){var e=Math[t];return function(t,r){if(t=xt(t),(r=null==r?0:It(Bt(r),292))&&Tt(t)){var n=(pt(t)+"e").split("e");return+((n=(pt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),Nt=Ut;function Dt(t){if(!Et(t))return 0;t=kt(t);let e=Nt(t);return"0"===String(e)?0:e}let Lt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Rt=Lt.length;function qt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];var r;t=Mt(r=t)&&Dt(r)>0?Dt(t):32;for(let r=0;r<t;r++)e[r]=Lt[0|Math.random()*Rt];return e.join("")}function Ht(t){return"[object Object]"===Object.prototype.toString.call(t)}function Vt(t){var e=this.__data__=new K(t);this.size=e.size}Vt.prototype.clear=function(){this.__data__=new K,this.size=0},Vt.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Vt.prototype.get=function(t){return this.__data__.get(t)},Vt.prototype.has=function(t){return this.__data__.has(t)},Vt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof K){var n=r.__data__;if(!Q||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(t,e),this.size=r.size,this};function Wt(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Y;++e<r;)this.add(t[e])}function Jt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Gt(t,e){return t.has(e)}Wt.prototype.add=Wt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Wt.prototype.has=function(t){return this.__data__.has(t)};var Kt=1,Qt=2;function Xt(t,e,r,n,o,i){var u=r&Kt,a=t.length,c=e.length;if(a!=c&&!(u&&c>a))return!1;var s=i.get(t),f=i.get(e);if(s&&f)return s==e&&f==t;var l=-1,p=!0,h=r&Qt?new Wt:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var d=t[l],y=e[l];if(n)var v=u?n(y,d,l,e,t,i):n(d,y,l,t,e,i);if(void 0!==v){if(v)continue;p=!1;break}if(h){if(!Jt(e,(function(t,e){if(!Gt(h,e)&&(d===t||o(d,t,r,n,i)))return h.push(e)}))){p=!1;break}}else if(d!==y&&!o(d,y,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}var Yt=a.Uint8Array;function Zt(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function te(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var ee=1,re=2,ne="[object Boolean]",oe="[object Date]",ie="[object Error]",ue="[object Map]",ae="[object Number]",ce="[object RegExp]",se="[object Set]",fe="[object String]",le="[object Symbol]",pe="[object ArrayBuffer]",he="[object DataView]",de=c?c.prototype:void 0,ye=de?de.valueOf:void 0;var ve=Object.prototype.propertyIsEnumerable,be=Object.getOwnPropertySymbols,ge=be?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(be(t),(function(e){return ve.call(t,e)})))}:function(){return[]},_e=ge;function je(t){return g(t)&&"[object Arguments]"==b(t)}var we=Object.prototype,me=we.hasOwnProperty,Oe=we.propertyIsEnumerable,Se=je(function(){return arguments}())?je:function(t){return g(t)&&me.call(t,"callee")&&!Oe.call(t,"callee")},xe=Se;var Ae="object"==typeof exports&&exports&&!exports.nodeType&&exports,Pe=Ae&&"object"==typeof module&&module&&!module.nodeType&&module,ze=Pe&&Pe.exports===Ae?a.Buffer:void 0,Be=(ze?ze.isBuffer:void 0)||function(){return!1},$e=9007199254740991,Ce=/^(?:0|[1-9]\d*)$/;function Fe(t,e){var r=typeof t;return!!(e=null==e?$e:e)&&("number"==r||"symbol"!=r&&Ce.test(t))&&t>-1&&t%1==0&&t<e}var Ee=9007199254740991;function ke(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Ee}var Me={};Me["[object Float32Array]"]=Me["[object Float64Array]"]=Me["[object Int8Array]"]=Me["[object Int16Array]"]=Me["[object Int32Array]"]=Me["[object Uint8Array]"]=Me["[object Uint8ClampedArray]"]=Me["[object Uint16Array]"]=Me["[object Uint32Array]"]=!0,Me["[object Arguments]"]=Me["[object Array]"]=Me["[object ArrayBuffer]"]=Me["[object Boolean]"]=Me["[object DataView]"]=Me["[object Date]"]=Me["[object Error]"]=Me["[object Function]"]=Me["[object Map]"]=Me["[object Number]"]=Me["[object Object]"]=Me["[object RegExp]"]=Me["[object Set]"]=Me["[object String]"]=Me["[object WeakMap]"]=!1;var Te="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ie=Te&&"object"==typeof module&&module&&!module.nodeType&&module,Ue=Ie&&Ie.exports===Te&&i.process,Ne=function(){try{var t=Ie&&Ie.require&&Ie.require("util").types;return t||Ue&&Ue.binding&&Ue.binding("util")}catch(t){}}(),De=Ne&&Ne.isTypedArray,Le=De?function(t){return function(e){return t(e)}}(De):function(t){return g(t)&&ke(t.length)&&!!Me[b(t)]},Re=Le,qe=Object.prototype.hasOwnProperty;function He(t,e){var r=o(t),n=!r&&xe(t),i=!r&&!n&&Be(t),u=!r&&!n&&!i&&Re(t),a=r||n||i||u,c=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],s=c.length;for(var f in t)!e&&!qe.call(t,f)||a&&("length"==f||i&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Fe(f,s))||c.push(f);return c}var Ve=Object.prototype;var We=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Je=We,Ge=Object.prototype.hasOwnProperty;function Ke(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Ve))return Je(t);var e,r,n=[];for(var o in Object(t))Ge.call(t,o)&&"constructor"!=o&&n.push(o);return n}function Qe(t){return null!=(e=t)&&ke(e.length)&&!z(e)?He(t):Ke(t);var e}function Xe(t){return function(t,e,r){var n=e(t);return o(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Qe,_e)}var Ye=1,Ze=Object.prototype.hasOwnProperty;var tr=L(a,"DataView"),er=L(a,"Promise"),rr=L(a,"Set"),nr=L(a,"WeakMap"),or="[object Map]",ir="[object Promise]",ur="[object Set]",ar="[object WeakMap]",cr="[object DataView]",sr=E(tr),fr=E(Q),lr=E(er),pr=E(rr),hr=E(nr),dr=b;(tr&&dr(new tr(new ArrayBuffer(1)))!=cr||Q&&dr(new Q)!=or||er&&dr(er.resolve())!=ir||rr&&dr(new rr)!=ur||nr&&dr(new nr)!=ar)&&(dr=function(t){var e=b(t),r="[object Object]"==e?t.constructor:void 0,n=r?E(r):"";if(n)switch(n){case sr:return cr;case fr:return or;case lr:return ir;case pr:return ur;case hr:return ar}return e});var yr=dr,vr=1,br="[object Arguments]",gr="[object Array]",_r="[object Object]",jr=Object.prototype.hasOwnProperty;function wr(t,e,r,n,i,u){var a=o(t),c=o(e),s=a?gr:yr(t),f=c?gr:yr(e),l=(s=s==br?_r:s)==_r,p=(f=f==br?_r:f)==_r,h=s==f;if(h&&Be(t)){if(!Be(e))return!1;a=!0,l=!1}if(h&&!l)return u||(u=new Vt),a||Re(t)?Xt(t,e,r,n,i,u):function(t,e,r,n,o,i,u){switch(r){case he:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case pe:return!(t.byteLength!=e.byteLength||!i(new Yt(t),new Yt(e)));case ne:case oe:case ae:return W(+t,+e);case ie:return t.name==e.name&&t.message==e.message;case ce:case fe:return t==e+"";case ue:var a=Zt;case se:var c=n&ee;if(a||(a=te),t.size!=e.size&&!c)return!1;var s=u.get(t);if(s)return s==e;n|=re,u.set(t,e);var f=Xt(a(t),a(e),n,o,i,u);return u.delete(t),f;case le:if(ye)return ye.call(t)==ye.call(e)}return!1}(t,e,s,r,n,i,u);if(!(r&vr)){var d=l&&jr.call(t,"__wrapped__"),y=p&&jr.call(e,"__wrapped__");if(d||y){var v=d?t.value():t,b=y?e.value():e;return u||(u=new Vt),i(v,b,r,n,u)}}return!!h&&(u||(u=new Vt),function(t,e,r,n,o,i){var u=r&Ye,a=Xe(t),c=a.length;if(c!=Xe(e).length&&!u)return!1;for(var s=c;s--;){var f=a[s];if(!(u?f in e:Ze.call(e,f)))return!1}var l=i.get(t),p=i.get(e);if(l&&p)return l==e&&p==t;var h=!0;i.set(t,e),i.set(e,t);for(var d=u;++s<c;){var y=t[f=a[s]],v=e[f];if(n)var b=u?n(v,y,f,e,t,i):n(y,v,f,t,e,i);if(!(void 0===b?y===v||o(y,v,r,n,i):b)){h=!1;break}d||(d="constructor"==f)}if(h&&!d){var g=t.constructor,_=e.constructor;g==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,i,u))}function mr(t,e,r,n,o){return t===e||(null==t||null==e||!g(t)&&!g(e)?t!=t&&e!=e:wr(t,e,r,n,mr,o))}function Or(t){return"[object Array]"===Object.prototype.toString.call(t)}function Sr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Ht(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!$t(t)||""!==t)}(t)||(!!function(t){return!!Or(t)&&0===t.length}(t)||!!Ft(t)))))}var xr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ar(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){if(this instanceof t){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(e,r))}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})})),r}var Pr={},zr={get exports(){return Pr},set exports(t){Pr=t}};var Br,$r={},Cr={get exports(){return $r},set exports(t){$r=t}},Fr=Ar(Object.freeze({__proto__:null,default:{}}));function Er(){return Br||(Br=1,function(t,e){var r;t.exports=(r=r||function(t,e){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==xr&&xr.crypto&&(r=xr.crypto),!r)try{r=Fr}catch(t){}var n=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var r;return t.prototype=e,r=new t,t.prototype=null,r}}(),i={},u=i.lib={},a=u.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},c=u.WordArray=a.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=r!=e?r:4*t.length},toString:function(t){return(t||f).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes,o=t.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var u=r[i>>>2]>>>24-i%4*8&255;e[n+i>>>2]|=u<<24-(n+i)%4*8}else for(var a=0;a<o;a+=4)e[n+a>>>2]=r[a>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],r=0;r<t;r+=4)e.push(n());return new c.init(e,t)}}),s=i.enc={},f=s.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],o=0;o<r;o++){var i=e[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new c.init(r,e/2)}},l=s.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],o=0;o<r;o++){var i=e[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new c.init(r,e)}},p=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},h=u.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r,n=this._data,o=n.words,i=n.sigBytes,u=this.blockSize,a=i/(4*u),s=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*u,f=t.min(4*s,i);if(s){for(var l=0;l<s;l+=u)this._doProcessBlock(o,l);r=o.splice(0,s),n.sigBytes-=f}return new c.init(r,f)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});u.Hasher=h.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new d.HMAC.init(t,r).finalize(e)}}});var d=i.algo={};return i}(Math),r)}(Cr)),$r}!function(t,e){t.exports=Er().enc.Utf8}(zr);var kr=Pr,Mr={};!function(t,e){var r;t.exports=(r=Er(),function(){var t=r,e=t.lib.WordArray;function n(t,r,n){for(var o=[],i=0,u=0;u<r;u++)if(u%4){var a=n[t.charCodeAt(u-1)]<<u%4*2|n[t.charCodeAt(u)]>>>6-u%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return e.create(o,i)}t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,n=this._map;t.clamp();for(var o=[],i=0;i<r;i+=3)for(var u=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<r;a++)o.push(n.charAt(u>>>6*(3-a)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(t){var e=t.length,r=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<r.length;i++)o[r.charCodeAt(i)]=i}var u=r.charAt(64);if(u){var a=t.indexOf(u);-1!==a&&(e=a)}return n(t,e,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),r.enc.Base64)}({get exports(){return Mr},set exports(t){Mr=t}});var Tr=Mr;var Ir="[object Boolean]";function Ur(t){return!0===(e=t)||!1===e||g(e)&&b(e)==Ir;var e}function Nr(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function Dr(t){if(!Mt(t))return!1;return Dt(t)>=0}function Lr(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if((!Or(o=e)||0===o.length||1===o.length&&Sr(o[0]))&&!Ct(e))throw new Error("args is not an effective array or string");var o;Ct(e)&&(e=[e]);let i=vt(r,"mode");"spawn"!==i&&"exec"!==i&&"execFile"!==i&&(i="spawn");let u=vt(r,"cbStdout"),a=vt(r,"cbStderr"),c=vt(r,"codeCmd");Ct(c)||(c="utf8");let s=vt(r,"useChcp");Ur(s)||(s=!1);let f=function(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}(),l="",p="",h=null;if("spawn"===i){let r=(y=1,Ct(d=t)&&Dr(y)?0===(y=Dt(y))?"":d.substring(0,y):""),o=function(t,e){if(!Ct(t))return"";if(!Dr(e))return"";if(0===(e=Dt(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}(t,1);if('"'===r||'"'===o||"'"===r||"'"===o)throw new Error("prog of spawn doens not need to add quotes");h=n.spawn(t,e,{encoding:c,shell:!1})}else if("exec"===i){let r="";s&&(r="cmd /c chcp 65001>nul &&"),h=n.exec(`${r} ${t} ${e.join(" ")} & exit`,{encoding:c})}else{if("execFile"!==i)throw new Error(`invalid mode[${i}]`);h=n.execFile(t,e,{encoding:c})}var d,y;return h.stdout.on("data",(t=>{let e=t.toString().trim();l+=e+"\n",Nr(u)&&u(e)})),h.stderr.on("data",(t=>{let e=t.toString().trim();p+=e+"\n",Nr(a)&&a(e)})),h.on("close",(t=>{Ct(p)?f.reject(p):f.resolve(l)})),h.on("error",(t=>{f.reject(t)})),f}function Rr(t){return function(t){let e=vt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"fs");return!!e.existsSync(t)&&!e.lstatSync(t).isDirectory()&&!e.lstatSync(t).isSymbolicLink()}(t,{fs:e})}let qr=t.resolve();return async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null;if("win32"!==r.platform)return Promise.reject("operating system is not windows");if(!function(t){if(Ht(t)){for(let e in t)return!0;return!1}return!1}(t))return Promise.reject("invalid input");let i=vt(t,"mode");if("logIn"!==i&&"listUsers"!==i)return Promise.reject("input.mode needs to be 'logIn or 'listUsers");if(!Ct(vt(t,"account")))return Promise.reject("invalid input.account");if(!Ct(vt(t,"password")))return Promise.reject("invalid input.password");if(!Ct(vt(t,"ldappath")))return Promise.reject("invalid input.ldappath");let u=vt(n,"ver",null);if(Ct(u)||(u="4.8"),!function(t,e){function r(t){return Or(t)?t:[t]}if(Sr(t))return!1;if(0===(t=r(t)).length)return!1;if(Sr(t))return!1;if(0===(e=r(e)).length)return!1;for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++)if(n=t[r],o=e[i],mr(n,o))return!0;var n,o;return!1}(u,["4.5","4.6","4.7.2","4.8"]))return Promise.reject("opt.ver needs to be one of 4.5, 4.6, 4.7.2 or 4.8");let a=`connLDAP.net${u}.exe`,c="";{let t=`${qr}/src/`,e=`${qr}/node_modules/w-ldap/src/`;if(Rr(`${t}${a}`))c=t;else{if(!Rr(`${e}${a}`))return Promise.reject("can not find folder for connLDAP");c=e}}let s=`${c}${a}`,f=`_${qt()}`;t["__System:OutputFilename"]=f;let l=function(t){if(!Ct(t))return"";let e=kr.parse(t);return Tr.stringify(e)}(JSON.stringify(t));await Lr(s,l).catch((t=>{console.log("execProcess catch",t),o=t.toString()}));let p=`${c}${f}`,h=null;try{let t=e.readFileSync(p,"utf8");t=t.replace(String.fromCharCode("65279"),""),h=function(t){if(!Ct(t))return{};let e={};try{e=JSON.parse(t)}catch(t){e={}}return e}(Ct(d=t)?Tr.parse(d).toString(kr):"")}catch(t){}var d;return e.unlinkSync(p),o?Promise.reject(o):vt(h,"error")?Promise.reject(h.error):vt(h,"success")||h}}));
//# sourceMappingURL=w-ldap.umd.js.map
